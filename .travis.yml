language: node_js
node_js:
  - '8'
install: true
branches:
  only:
    - master
    - /^version_\d+\.x$/
    - 796-i
cache:
  yarn: true
jobs:
  include:
    - script:
      - git config --global user.name "${GH_NAME}"
      - git config --global user.email "${GH_EMAIL}"
      - echo "machine github.com login ${GH_NAME} password ${GH_TOKEN}" > ~/.netrc
      - cd website && yarn install && GIT_USER="${GH_NAME}" yarn run publish-gh-pages
      name: "website"
    - script: npm run test:integration
      before_script: 
        # Install
        - npm install
      env: 
        - VERBOSE_TESTS=true
        - process.env.TEAMCITY_VERSION='bla'
      name: "test:integration"
    - script: npm run test:unit
      before_script: npm install
      name: "test:unit"
    - script: npm run test:app-flow
      before_script: npm install
      name: "test:app-flow"
    - script: npm run lint
      before_script: npm install
      name: "lint"
